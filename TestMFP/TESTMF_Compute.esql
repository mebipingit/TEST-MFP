

CREATE COMPUTE MODULE TESTMF_Compute

	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN
		DECLARE chTest1208 CHARACTER CAST(InputRoot.BLOB.BLOB AS CHARACTER CCSID 1208);
		DECLARE blbTest37 BLOB CAST(chTest1208 AS BLOB CCSID 37);	

											
	--	DECLARE blbMessage BLOB ASBITSTREAM(OutputRoot.DFDL OPTIONS options TYPE '{}:CSVMSG');
		
	--	DECLARE chMessage CHARACTER CAST (blbMessage AS CHARACTER CCSID 1208);
		
	--	DECLARE intBlbMessageLength INTEGER LENGTH(blbMessage);
	--	DECLARE intChMessageLength INTEGER LENGTH(chMessage);
		
		
		
	/*	CREATE LASTCHILD OF OutputRoot DOMAIN('DFDL')                            
       			PARSE(inBitStream, inEncoding, inCCSID, '',         
             	'{}:CSVMSG', '', options); 
     */        	
        RETURN TRUE;


	END;
		

	CREATE PROCEDURE CopyMessageHeaders() BEGIN
		DECLARE I INTEGER 1;
		DECLARE J INTEGER;
		SET J = CARDINALITY(InputRoot.*[]);
		WHILE I < J DO
			SET OutputRoot.*[I] = InputRoot.*[I];
			SET I = I + 1;
		END WHILE;
	END;

	CREATE PROCEDURE CopyEntireMessage() BEGIN
		SET OutputRoot = InputRoot;
	END;
END MODULE;

/*		CREATE FIRSTCHILD OF OutputRoot.XMLNSC TYPE XMLNSC.XmlDeclaration NAME 'XmlDeclaration'; 
		SET OutputRoot.XMLNSC.(XMLNSC.XmlDeclaration)*.(XMLNSC.Attribute)Version = '1.0'; 
		SET OutputRoot.XMLNSC.(XMLNSC.XmlDeclaration)*.(XMLNSC.Attribute)Encoding = 'UTF-8'; 
		SET OutputRoot.XMLNSC.(XMLNSC.XmlDeclaration)*.(XMLNSC.Attribute)StandAlone = 'yes'; 
		
		CREATE LASTCHILD OF OutputRoot.XMLNSC FROM InputBody.*[<] ;
	*/	

		
	/*	
		DECLARE CONTINUE HANDLER FOR SQLSTATE LIKE '%'
		BEGIN
			SET OutputRoot = InputRoot;
			RESIGNAL;
		END;
		CALL CopyEntireMessage();
		DECLARE myInt INTEGER 1/0;
		
				DECLARE chTS CHARACTER '2017-09-28 10:34:56.123456';
		
		DECLARE tsGMT GMTTIMESTAMP CAST(chTS AS GMTTIMESTAMP FORMAT 'yyyy-MM-dd hh:mm:ss.SSSSSS');
		
		DECLARE ts1 GMTTIMESTAMP CAST(3.1e0, 4.2e0, 5.3e0, 6.4e0, 7.5e0, 8.6789012e0 AS GMTTIMESTAMP);
		DECLARE ts2 GMTTIMESTAMP CAST(3.2, 4.3, 5.4, 6.5, 7.6, 8.7890135 AS GMTTIMESTAMP);
		SET OutputRoot.XMLNSC.Data.Record = SELECT 'Bipin', 'Singh' FROM InputBody;
		DECLARE blbMQMD BLOB x'4d442020020000000000000008000000ffffffff0000000022020000b80400004d515354522020200000000000000000414d5120494239514d475220202020201c3ddd5820003f0200000000000000000000000000000000000000000000000000000000202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020494239514d47522020202020202020202020202020202020202020202020202020202020202020202020202020202020534f4e592020202020202020160105150000006ab29c814bd0d74dc8060818ea03000000000000000000000b20202020202020202020202020202020202020202020202020202020202020200b000000537068657265204d515c62696e5c4d514578706c6f7265722e6578653230313730333330313733323234383020202020000000000000000000000000000000000000000000000000010000000000000000000000ffffffff' ;
		
		CREATE LASTCHILD OF OutputRoot DOMAIN ('MQMD') PARSE (blbMQMD) ;
			
	*/	
	/*
			DECLARE blbNewLine BLOB X'0d0d';
		DECLARE intLength INTEGER LENGTH(blbNewLine);
		
		--SET OutputRoot.Properties.MessageType   = '{}:CSVMSG';
		DECLARE refOut REFERENCE TO OutputRoot;
		
		DECLARE options INTEGER BITOR(FolderBitStream, ValidateContentAndValue);
		
		DECLARE inCCSID INT InputProperties.CodedCharSetId;                     
		DECLARE inEncoding INT InputProperties.Encoding;                        
		DECLARE inBitStream BLOB InputRoot.BLOB.BLOB;
		
		CREATE LASTCHILD OF OutputRoot DOMAIN('DFDL') ;
		SET OutputRoot.DFDL.CSVMSG = ROW ('EMP_NM' AS header.head_field1
											,'EMP_ID' AS header.head_field2
											,'EMP_DEPT' AS header.head_field3);
											
		SET OutputRoot.DFDL.CSVMSG.record = ROW ('A' AS field1
											,'B' AS field2
											,'C' AS field3);
											
		DECLARE blbMessage1 BLOB ASBITSTREAM(OutputRoot.DFDL);
	*/
